## 08/22/2025

**Refactor LZ4 build system, packaging, and tests**

---

## Summary

This PR modernizes **The LZ4 Library** build setup, removes legacy changelog/config tooling, introduces a flexible multi-variant CMake system, updates licensing headers, and adds a unified build/test workflow with coverage support.

---

## Key Changes

### 🔧 Build & Tooling

* Removed legacy files:

    * `.changes/*`, `.changie.yaml`, `CHANGELOG.md`, `NEWS.md`, `build_install.sh`.
* Added unified **`build.sh`** with commands:

    * `build`, `install`, `coverage`, `clean`.
* Expanded `.gitignore` for new build dirs (`build-unix_makefiles`, `build-cov`, `build-coverage`).
* Updated **`BUILDING.md`**:

    * Clear local build instructions.
    * Optional dependency setup (`a-memory-library`).
    * Modern Dockerfile included.
* Dockerfile rewritten:

    * Base **Ubuntu** image with configurable CMake.
    * Proper dev tooling, non-root `dev` user.
    * Explicit clone/build of `a-memory-library`.
    * Build/install this project into system prefix.

### 📦 CMake

* Bumped minimum version to **3.20**.
* Replaced legacy macros with modern CMake.
* Introduced **multi-variant builds**:

    * `debug`, `memory`, `static`, `shared`.
    * Umbrella alias: `the_lz4_library::the_lz4_library` selects one variant.
* Coverage instrumentation toggle (`A_ENABLE_COVERAGE`).
* Memory profiling macro opt-in (`_AML_DEBUG_`).
* Proper **install/export**:

    * Config + version files.
    * Namespace: `the_lz4_library::`.
* Unified test integration (`enable_testing() + add_subdirectory(tests)`).

### 📚 Documentation & Metadata

* AUTHORS: updated contact to angle-bracket format, added GitHub link.
* NOTICE: simplified (Apache-2.0 note moved up, cleaner format).
* Removed autogenerated changelogs (`.changes/*`, `NEWS.md`, `CHANGELOG.md`).

### 📝 License Headers

* Updated to use en-dash year ranges (`2019–2025`).
* Added note for Knode.ai: “technical questions: contact Andy”.

### 🛠️ Tests

* New `tests/CMakeLists.txt`:

    * Explicit test executable `test_lz4`.
    * Proper warnings, coverage flags, math lib linking.
    * Coverage aggregation with `llvm-profdata` + `llvm-cov` (HTML + console).
* Added `tests/build.sh` helper:

    * Variants (`debug|memory|static|shared|coverage`).
    * Coverage toggle, auto-detect job count.
* `test_lz4.c`:

    * Function signatures corrected (`void` style).
    * Updated SPDX headers.

---

## Impact

* 🚀 Builds are modernized and consistent across environments (local, Docker, CI).
* 🛡️ Flexible multi-variant outputs (debug, static, shared, memory-profile).
* 📖 Docs are simpler, with fewer redundant changelog files.
* ✅ High confidence from updated tests and coverage workflow.
